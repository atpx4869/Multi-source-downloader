# 标准号处理Web应用使用指南

## 🌐 Web应用版本

一个美观、易用的Web界面，用于批量处理Excel中的标准号。

## 🚀 快速启动

### Windows用户

双击运行 `web_app/启动Web应用.bat`，浏览器会自动打开应用界面。

### 手动启动

1. **安装依赖**
```bash
pip install -r web_app/requirements_web.txt
```

2. **启动服务**
```bash
cd web_app
python web_app.py
```

3. **访问应用**
打开浏览器访问：http://127.0.0.1:5000

## 📖 使用步骤

### 1. 上传Excel文件

- 点击上传区域或拖拽文件到页面
- 支持 `.xlsx` 和 `.xls` 格式
- 文件大小限制：16MB

### 2. 配置参数

- **标准号所在列**：输入列字母（如 `A`）
- **开始行号**：输入开始处理的行号（如 `2`，第1行通常是表头）
- **结果标准号列**：输入结果写入的列（如 `B`）
- **结果标准名称列**：输入结果写入的列（如 `C`）

### 3. 开始处理

点击"开始处理"按钮，系统会：
1. 自动读取Excel文件
2. 逐行处理每个标准号
3. 实时显示处理进度和日志
4. 显示成功/失败统计

### 4. 下载结果

处理完成后：
- 点击"下载结果文件"获取处理后的Excel
- 或点击"处理新文件"继续处理其他文件

## 🎨 界面功能

### 实时进度显示

- **进度条**：显示整体处理进度（百分比）
- **当前行**：正在处理的行号
- **总行数**：需要处理的总行数
- **成功数**：已成功处理的数量
- **失败数**：处理失败的数量
- **耗时**：已用时间

### 处理日志

实时显示最近的处理日志，包括：
- 每行的处理状态
- 查询到的标准信息
- 错误信息（如果有）

## 📊 示例

### 输入Excel

| A列 | B列 | C列 |
|-----|-----|-----|
| 标准号 | | |
| GB/T 3324 | | |
| GB/T 3325-2024 | | |
| GB 50010 | | |

### 输出Excel

| A列 | B列 | C列 |
|-----|-----|-----|
| 标准号 | 完整标准号 | 标准名称 |
| GB/T 3324 | GB/T 3324-2024 | 木家具通用技术条件 |
| GB/T 3325-2024 | GB/T 3325-2024 | 金属家具通用技术条件 |
| GB 50010 | GB 50010-2010 | 混凝土结构设计规范 |

## 🔧 高级功能

### API接口

Web应用也提供了API接口，可以集成到其他系统中：

#### 1. 搜索单个标准

```bash
POST /api/search
Content-Type: application/json

{
  "std_no": "GB/T 3324"
}
```

响应：
```json
{
  "std_no": "GB/T 3324",
  "full_std_no": "GB/T 3324-2024",
  "name": "木家具通用技术条件",
  "status": "成功"
}
```

#### 2. 健康检查

```bash
GET /health
```

查看各数据源的健康状态。

## 🛠️ 技术栈

- **后端**：Flask（Python Web框架）
- **前端**：原生HTML/CSS/JavaScript
- **数据处理**：Pandas + openpyxl
- **标准查询**：项目内置的统一API

## 📁 文件说明

```
multi-source-downloader/
└── web_app/
    ├── web_app.py                 # Web应用主程序
    ├── templates/
    │   └── index.html            # Web界面
    ├── uploads/                  # 上传文件临时目录（自动创建）
    ├── results/                  # 结果文件目录（自动创建）
    ├── requirements_web.txt      # Web应用依赖
    ├── 启动Web应用.bat           # Windows快速启动脚本
    └── WEB_APP_GUIDE.md          # 使用指南
```

## ⚡ 性能说明

- **处理速度**：每个标准约需要2-5秒（取决于网络和数据源响应）
- **并发处理**：支持多个用户同时使用
- **文件大小**：建议单个文件不超过1000行
- **后台处理**：上传后在后台异步处理，不会阻塞界面

## 🔒 安全说明

- 文件上传使用安全文件名处理
- 每个任务使用唯一ID隔离
- 临时文件在服务器重启后会被清理
- 建议在内网环境使用

## 🐛 故障排除

### 问题1：端口已被占用

```
Address already in use
```

**解决方法**：
- 更改端口号：编辑 `web_app/web_app.py`，修改最后一行的 `port=5000` 为其他端口
- 或关闭占用5000端口的程序

### 问题2：导入模块失败

```
ModuleNotFoundError: No module named 'flask'
```

**解决方法**：
```bash
pip install -r web_app/requirements_web.txt
```

### 问题3：处理卡住

- 检查网络连接
- 查看日志输出
- 刷新页面重新开始

## 💡 使用建议

1. **测试小文件**：首次使用建议先用10-20行的小文件测试
2. **保持网络**：确保网络连接稳定
3. **分批处理**：如果数据量很大，建议分批处理
4. **备份原文件**：处理前备份原始Excel文件

## 📞 技术支持

如有问题，请查看项目文档：
- `README.md` - 项目说明
- `API_GUIDE.md` - API使用指南
- `EXCEL_TOOL_README.md` - 命令行工具说明

## 🎉 特色功能

✅ 美观的现代化界面
✅ 实时进度和日志显示
✅ 拖拽上传文件
✅ 自动识别标准号格式
✅ 智能查找现行标准
✅ 多源数据查询
✅ 详细的处理统计
✅ 一键下载结果

---

**享受使用！** 🚀
